function [yup tup] = upsa(y,dt,N)


%===========================================================================================================================================================
%***********************************************************************************************************************************************************
%
%                                      --------------------------------------------------
%                                                          PREAMBLE
%                                      --------------------------------------------------
%
%
%By Adarsh S, Ph.D. Candidate IIT Kanpur
%
%This function upsamples the measurements in y by N times (N should be an integer)
%y contains the measurements in rows
% dt is the original sampling time
%yup is the upsampled measurements
%tup is the upsampled time axis
%Ex:  [yup tup] = upsa(y(1:1001),0.01,10) ;
%
%                                      -----------------------------------------------
%                            *********|| All rights reserved; Adarsh S; October, 2019 || *********
%                                      -----------------------------------------------
%
%
%***********************************************************************************************************************************************************
%===========================================================================================================================================================

y = y' ;
[my ny] = size(y) ;
M = mod(my,2) ;

if M ~= 0
    y = [y;zeros(1,ny)] ;
    my = my + 1 ;
end

Pad = zeros((N-1)*my,ny) ;
Y = fft(y) ;
Yup = N*[Y(1:(my/2)+1,:) ; Pad ; Y((my/2)+2:my,:) ] ;
yup = ifft(Yup) ;
yup = (real(yup))' ;
tup = (0:1:(N*my)-1)*(dt/N) ;

if M ~= 0
    yup = yup(1:(my-2)*N+1) ;
    tup = tup(1:(my-2)*N+1) ;
end

%===========================================================================================================================================================

end

    